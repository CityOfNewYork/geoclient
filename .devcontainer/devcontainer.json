{
	"name": "geoclient",
	//"image": "mcr.microsoft.com/devcontainers/java:1-8-bullseye",
	"build":{
		"dockerfile": "Dockerfile"
	},
	"features": {
		"ghcr.io/devcontainers/features/java:1": {
			"version": "8",
			"installMaven": "true",
			"installGradle": "true"
		},
		"ghcr.io/devcontainers/features/node:1": {
			"version": "none"
		},
		"ghcr.io/devcontainers/features/git:1": {
            "version": "latest",
            "ppa": "false"
        }
	},

	// Configure tool-specific properties.
	"customizations": {
		// Configure properties specific to VS Code.
		"vscode": {
			// Set *default* container specific settings.json values on container create.
			"settings": {
				"java.import.gradle.java.home": "/usr/local/sdkman/candidates/java/current",
				"java.configuration.runtimes": [
					{
						"default": true,
						"name": "JavaSE-1.8",
						"path": "/usr/local/sdkman/candidates/java/current"
					}
				]
			},
			"extensions": [
				"vscjava.vscode-java-pack"
			]
		}
	},

	"forwardPorts": ["8080:8080", "8000:8000","5005:5005"],
	"mounts": [
		"source=geosupport-22c_22.3,target=/opt/geosupport/version-22c_22.3,type=volume"
		//"source=${localEnv:HOME}/Workspace/repo/geosupport,target=/opt/geosupport,type=bind,consistency=cached",
		//"source=geoclient-bashhistory,target=/commandhistory,type=volume",
		//"source=geoclient-vscode-extensions,target=/root/.vscode-server/extensions,type=volume",
		//"source=geoclient-vscode-insiders-extensions,target=/root/.vscode-server-insiders/extensions,type=volume"
	],

	// Use 'postCreateCommand' to run commands after the container is created.
	// For now, this command requires root since it is not part of the Dockerfile
	// TODO figure out how to use sudo in this context or change Dockerfile to use geosupport-docker
	"postCreateCommand": "/opt/geosupport/version-22c_22.3/bin/geosupport install",

	"remoteEnv": {
		"PATH": "${containerEnv:PATH}:/opt/geosupport/current/bin"
	},
	"runArgs": [
		"--env-file=${localWorkspaceFolder}/.devcontainer/geosupport.env"
	],
	// More info: https://aka.ms/dev-containers-non-root.
	"remoteUser": "root"
}
